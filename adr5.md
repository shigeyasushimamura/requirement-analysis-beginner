# ADR-005: 署名付きイベントと認可制御によるデータ完全性とプライバシー保護

- **Status:** Accepted
- **Date:** 2025-12-24

# Context

- 配送ログが改ざんされた場合、法的責任の所在が不明確になる
- 追跡 ID の推測による個人情報のスクレイピング(IDOR Insecure Direct Object Reference)を防ぐ必要がある

# Decision

- デジタル署名: イベント生成時に端末側でペイロードに署名を行い、ドメイン層で検証することで、非否認性を担保する
- 非推測的識別子: ShipmentID に UUID v4 または HashID を使用
- 認可レベルの階層化
  - 公開アクセス: 拠点名までの匿名データ
  - 認証済みアクセス: 完全な住所・氏名

# Consequence

- Positive: データの完全性が証明され、内部不正や外部攻撃からの保護が可能になる
- Negative: 暗号化・複合処理による CPU 負荷の増大と、鍵管理(KMS)の運用コストが発生する
